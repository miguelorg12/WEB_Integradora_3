import{a as L}from"./chunk-LL344L2T.js";import{a as J}from"./chunk-RMDRK64P.js";import{a as B}from"./chunk-N7WXRUGI.js";import{a as $}from"./chunk-NHY6G2KS.js";import"./chunk-VZAEZB6E.js";import{b as f,c as N,d as M,e as O,f as v,g as j,i as V,j as A,k as z,l as G,m as R,o as D,q as H}from"./chunk-FJBITYPR.js";import{a as U}from"./chunk-67ANC6KW.js";import{h as T,j as q}from"./chunk-6X3NTM2I.js";import{Ab as p,Ib as d,Jb as _,Kb as C,Qb as I,Sa as s,Ta as g,ga as b,gb as m,ib as l,jc as F,kc as w,lc as k,pa as S,qa as y,qb as o,rb as i,sb as x,vb as E,yb as h}from"./chunk-QODOQ2ZI.js";function Q(e,r){if(e&1&&(o(0,"option",22),d(1),i()),e&2){let n=r.$implicit;l("value",n.id),s(),_(n.nombre)}}function W(e,r){e&1&&(o(0,"p",24),d(1,"El hospital es requerido"),i())}function X(e,r){if(e&1&&(o(0,"div"),m(1,W,2,0,"p",23),i()),e&2){let n=p(2);s(),l("ngIf",n.Form.controls.id_hospital.errors.required)}}function Y(e,r){if(e&1&&(o(0,"div")(1,"label",14),d(2,"Hospital"),i(),o(3,"div",8)(4,"select",21),m(5,Q,2,2,"option",19),i(),m(6,X,2,1,"div",6),i()()),e&2){let n=p();s(5),l("ngForOf",n.hospitales),s(),l("ngIf",n.Form.controls.id_hospital.errors&&n.Form.controls.id_hospital.touched)}}function Z(e,r){e&1&&(o(0,"p",24),d(1,"El estado es requerido"),i())}function ee(e,r){if(e&1&&(o(0,"div"),m(1,Z,2,0,"p",23),i()),e&2){let n=p();s(),l("ngIf",n.Form.controls.is_active.errors.required)}}function te(e,r){e&1&&(o(0,"p",24),d(1,"El estado de ocupaci\xF3n es requerido"),i())}function ie(e,r){if(e&1&&(o(0,"div"),m(1,te,2,0,"p",23),i()),e&2){let n=p();s(),l("ngIf",n.Form.controls.is_occupied.errors.required)}}function oe(e,r){if(e&1){let n=E();o(0,"div")(1,"label")(2,"input",25),h("change",function(c){let a=S(n).$implicit,u=p();return y(u.agregarSensor(c,a.id))}),i(),d(3),i()()}if(e&2){let n=r.$implicit,t=p();s(2),l("value",n.id)("checked",t.sensoresSeleccionados.includes(n.id)),s(),C(" ",n.nombre," ")}}function ne(e,r){e&1&&(o(0,"div")(1,"p",24),d(2,"Al menos 1 sensor es requerido"),i()())}function re(e,r){if(e&1&&(o(0,"option",22),d(1),i()),e&2){let n=r.$implicit;l("value",n.id),s(),_(n.estado)}}function se(e,r){e&1&&(o(0,"p",24),d(1,"El estado es requerido"),i())}function ae(e,r){if(e&1&&(o(0,"div"),m(1,se,2,0,"p",23),i()),e&2){let n=p();s(),l("ngIf",n.Form.controls.id_estado.errors.required)}}function de(e,r){if(e&1&&(o(0,"div")(1,"p",26),d(2),i()()),e&2){let n=p();s(2),_(n.succesMessages.message)}}function le(e,r){if(e&1&&(o(0,"div")(1,"p",24),d(2),i()()),e&2){let n=p();s(2),_(n.backendErrors.message)}}var Se=(()=>{let r=class r{constructor(t,c,a,u,K,P){this.router=t,this.incubadorasService=c,this.hospitalesService=a,this.sensoresService=u,this.cookies=K,this.route=P,this.hospitales=[],this.estados=[],this.sensoresSeleccionados=[],this.sensores=[],this.backendErrors={},this.succesMessages={},this.Form=new O({id_hospital:new v("",[f.required]),id_estado:new v("",[f.required]),is_active:new v("",[f.required]),id_sensores:new v([],[f.required]),is_occupied:new v("",[f.required])})}ngAfterContentInit(){this.id_rol=this.cookies.get("id_rol"),this.hospitalesService.getHospitales().subscribe({next:t=>{this.hospitales=t.Hospitales,console.log(this.hospitales)},error:t=>{console.log(t)}}),this.sensoresService.getSensores().subscribe({next:t=>{console.log(t),this.sensores=t.data,console.log(this.sensores)},error:t=>{console.log(t)}}),this.incubadorasService.getIncubadorabyId(this.route.snapshot.params.id).subscribe({next:t=>{console.log(t),this.Form.setValue({id_hospital:t.Incubadora.id_hospital,id_estado:t.Incubadora.id_estado,is_active:t.Incubadora.is_active,id_sensores:t.Sensores.map(c=>c.id_sensor),is_occupied:t.Incubadora.is_occupied}),this.sensoresSeleccionados=t.Sensores.map(c=>c.id_sensor)},error:t=>{console.log(t)}}),this.incubadorasService.getEstadosIncubadora().subscribe({next:t=>{console.log(t),this.estados=t.estado,console.log(this.estados)},error:t=>{console.log(t)}})}updateIncubadora(){this.Form.valid&&this.incubadorasService.updateIncubadora(this.Form.value,this.route.snapshot.params.id).subscribe({next:t=>{console.log(t),this.succesMessages.message="Incubadora actualizada exitosamente",this.backendErrors.message="",setTimeout(()=>{this.succesMessages.message="",this.router.navigate(["/incubadoras"])},2e3)},error:t=>{console.log(t),this.backendErrors.message="Error al actualizar intente mas tarde"}})}agregarSensor(t,c){if(t.target.checked)this.sensoresSeleccionados.push(c),console.log(this.sensoresSeleccionados);else{let u=this.sensoresSeleccionados.indexOf(c);u>-1&&(this.sensoresSeleccionados.splice(u,1),console.log(this.sensoresSeleccionados))}let a=this.Form.get("id_sensores");a&&(a.setValue(this.sensoresSeleccionados),console.log(a.value))}};r.\u0275fac=function(c){return new(c||r)(g(q),g(J),g($),g(L),g(U),g(T))},r.\u0275cmp=b({type:r,selectors:[["app-update"]],standalone:!0,features:[I],decls:46,vars:10,consts:[[1,"flex","mt-10","flex-col","justify-center"],[1,"sm:mx-auto","sm:w-1/2","sm:max-w-2xl"],["src","assets/logo.jpeg","alt","Logo",1,"mx-auto","h-32","w-auto"],[1,"mt-3","text-center","text-2xl","font-bold","leading-9","tracking-tight","text-violet-950"],[1,"sm:mx-auto","sm:w-1/3","sm:max-w-2xl"],[1,"space-y-2",3,"formGroup"],[4,"ngIf"],["for","is_active",1,"block","text-sm","font-medium","leading-6","text-gray-900"],[1,"mt-2"],["formControlName","is_active","name","is_active","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6"],["value","1"],["value","0"],["for","is_occupied",1,"block","text-sm","font-medium","leading-6","text-gray-900"],["formControlName","is_occupied","name","is_occupied","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6"],["for","hospital",1,"block","text-sm","font-medium","leading-6","text-gray-900"],[1,"grid","grid-cols-3","gap-4"],[4,"ngFor","ngForOf"],["for","maintenance",1,"block","text-sm","font-medium","leading-6","text-gray-900"],["formControlName","id_estado","name","maintenance","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6"],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"flex","w-full","justify-center","rounded-md","bg-fuchsia-500","px-3","py-1.5","text-sm","font-semibold","leading-6","text-white","shadow-sm","hover:bg-cyan-700","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600",3,"click"],["formControlName","id_hospital","name","hospital","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6"],[3,"value"],["class","text-red-500 font-medium text-sm",4,"ngIf"],[1,"text-red-500","font-medium","text-sm"],["type","checkbox",3,"change","value","checked"],[1,"text-green-500","font-medium","text-sm"]],template:function(c,a){c&1&&(x(0,"app-toolbar"),o(1,"div",0)(2,"div",1),x(3,"img",2),o(4,"h2",3),d(5,"Actualizar Incubadora"),i()(),o(6,"div",4)(7,"form",5),m(8,Y,7,2,"div",6),o(9,"div")(10,"label",7),d(11,"Estado de la incubadora"),i(),o(12,"div",8)(13,"select",9)(14,"option",10),d(15,"Activa"),i(),o(16,"option",11),d(17,"Inactiva"),i()(),m(18,ee,2,1,"div",6),i()(),o(19,"div")(20,"label",12),d(21,"Ocupaci\xF3n de la incubadora"),i(),o(22,"div",8)(23,"select",13)(24,"option",10),d(25,"Ocupada"),i(),o(26,"option",11),d(27,"Desocupada"),i()(),m(28,ie,2,1,"div",6),i()(),o(29,"label",14),d(30,"Actualizar o agregar sensores"),i(),o(31,"div",15),m(32,oe,4,3,"div",16),i(),m(33,ne,3,0,"div",6),o(34,"div")(35,"label",17),d(36,"Estado del Mantenimiento"),i(),o(37,"div",8)(38,"select",18),m(39,re,2,2,"option",19),i(),m(40,ae,2,1,"div",6),i()(),m(41,de,3,1,"div",6)(42,le,3,1,"div",6),o(43,"div")(44,"button",20),h("click",function(){return a.updateIncubadora()}),d(45,"Actualizar Incubadora"),i()()()()()),c&2&&(s(7),l("formGroup",a.Form),s(),l("ngIf",a.id_rol==1),s(10),l("ngIf",a.Form.controls.is_active.errors&&a.Form.controls.is_active.touched),s(10),l("ngIf",a.Form.controls.is_occupied.errors&&a.Form.controls.is_occupied.touched),s(4),l("ngForOf",a.sensores),s(),l("ngIf",a.sensoresSeleccionados.length===0),s(6),l("ngForOf",a.estados),s(),l("ngIf",a.Form.controls.id_estado.errors&&a.Form.controls.id_estado.touched),s(),l("ngIf",a.succesMessages.message),s(),l("ngIf",a.backendErrors.message))},dependencies:[B,k,F,w,H,j,G,R,z,N,M,D,V,A]});let e=r;return e})();export{Se as UpdateComponent};
