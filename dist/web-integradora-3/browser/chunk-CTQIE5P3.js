import{a as H}from"./chunk-QVIXLOYS.js";import{j as R}from"./chunk-3MERXQHR.js";import"./chunk-FN7DCFEX.js";import"./chunk-FEMZR6YW.js";import{a as P,b as d,c as N,d as V,e as q,f as _,g as L,j as M,k as j,l as A,m as z,n as G,p as O,r as D}from"./chunk-FA5XPTQ2.js";import"./chunk-5IC5DNT2.js";import{a as T}from"./chunk-BI5OWTDL.js";import{a as k}from"./chunk-JRUOX2RA.js";import{j as F}from"./chunk-SD2P4HH3.js";import{Bb as f,Jb as a,Kb as E,Rb as S,Ta as n,Ua as u,ga as y,hb as c,jb as r,mc as C,nc as I,pc as w,qa as h,ra as x,rb as i,sb as t,tb as g,wb as v,zb as b}from"./chunk-XQ3MI7UQ.js";function $(e,o){e&1&&(i(0,"p",17),a(1,"El nombre es requerido"),t())}function Z(e,o){e&1&&(i(0,"p",17),a(1,"El nombre tiene un minimo de 3 caracteres"),t())}function B(e,o){e&1&&(i(0,"p",17),a(1,"El nombre tiene un maximo de 50 caracteres"),t())}function J(e,o){e&1&&(i(0,"p",17),a(1,"El nombre solo puede contener espacios y letras"),t())}function K(e,o){if(e&1&&(i(0,"div"),c(1,$,2,0,"p",16)(2,Z,2,0,"p",16)(3,B,2,0,"p",16)(4,J,2,0,"p",16),t()),e&2){let s=f();n(),r("ngIf",s.profileForm.controls.name.errors.required),n(),r("ngIf",s.profileForm.controls.name.errors.minlength),n(),r("ngIf",s.profileForm.controls.name.errors.maxlength),n(),r("ngIf",s.profileForm.controls.name.errors.pattern)}}function Q(e,o){e&1&&(i(0,"p",17),a(1,"Los apellidos son requeridos"),t())}function W(e,o){e&1&&(i(0,"p",17),a(1,"Los apellidos tienen un minimo de 3 caracteres"),t())}function X(e,o){e&1&&(i(0,"p",17),a(1,"Los apellidos tienen un maximo de 50 caracteres"),t())}function Y(e,o){e&1&&(i(0,"p",17),a(1,"Los apellidos solo pueden contener espacios y letras"),t())}function ee(e,o){if(e&1&&(i(0,"div"),c(1,Q,2,0,"p",16)(2,W,2,0,"p",16)(3,X,2,0,"p",16)(4,Y,2,0,"p",16),t()),e&2){let s=f();n(),r("ngIf",s.profileForm.controls.last_name.errors.required),n(),r("ngIf",s.profileForm.controls.last_name.errors.minlength),n(),r("ngIf",s.profileForm.controls.last_name.errors.maxlength),n(),r("ngIf",s.profileForm.controls.last_name.errors.pattern)}}function te(e,o){if(e&1&&(i(0,"option",18),a(1),t()),e&2){let s=o.$implicit;r("value",s.id),n(),E(s.nombre)}}function ie(e,o){e&1&&(i(0,"div")(1,"p",19),a(2,"Actualizacion Correcta"),t()())}function oe(e,o){if(e&1){let s=v();i(0,"button",20),b("click",function(){h(s);let p=f();return x(p.toggleEdit())}),a(1,"Editar"),t()}}function ne(e,o){if(e&1){let s=v();i(0,"button",20),b("click",function(){h(s);let p=f();return x(p.update())}),a(1,"Guardar"),t()}}var ge=(()=>{let o=class o{constructor(l,p,m,U){this.usuarioService=l,this.cookie=p,this.hospitalService=m,this.router=U,this.hospitales=[],this.usuario_nombre="",this.usuario_apellidos="",this.usuario_hospital="",this.id=0,this.IsEditable=!1,this.succesMessages={},this.profileForm=new q({name:new _("",[d.required,d.minLength(3),d.maxLength(50),d.pattern("^[a-zA-Z ]*$")]),last_name:new _("",[d.required,d.minLength(3),d.maxLength(50),d.pattern("^[a-zA-Z ]*$")]),id_hospital:new _(0)})}ngAfterContentInit(){this.usuario_nombre=this.cookie.get("nombre"),this.usuario_apellidos=this.cookie.get("apellido"),this.usuario_hospital=this.cookie.get("id_hospital"),this.hospitalService.getHospitales().subscribe(l=>{this.hospitales=l.Hospitales,console.log(this.hospitales)}),this.profileForm.setValue({name:this.usuario_nombre,last_name:this.usuario_apellidos,id_hospital:Number(this.usuario_hospital)}),console.log(this.profileForm.value)}toggleEdit(){this.IsEditable=!this.IsEditable}update(){this.IsEditable&&(this.id=Number(this.cookie.get("id")),console.log(this.id),this.profileForm.valid&&this.usuarioService.updateUser(this.profileForm.value,this.id).subscribe({next:l=>{console.log(l),console.log(this.profileForm.value),this.cookie.set("nombre",l.name,1),this.cookie.set("apellido",l.last_name,1),this.cookie.set("id_hospital",l.id_hospital.toString(),1),this.cookie.set("id_rol",l.rol.toString(),1),this.usuario_nombre=l.name,this.usuario_apellidos=l.last_name,this.usuario_hospital=l.id_hospital.toString(),this.IsEditable=!1,this.succesMessages.update="Usuario actualizado correctamente",setTimeout(()=>{this.succesMessages.update="",this.router.navigate(["/home"])},1e3)},error:l=>{console.log(l),this.succesMessages.update="Error al actualizar el usuario"}}))}};o.\u0275fac=function(p){return new(p||o)(u(T),u(k),u(H),u(F))},o.\u0275cmp=y({type:o,selectors:[["app-profile"]],standalone:!0,features:[S],decls:30,vars:10,consts:[[1,"flex","mt-10","flex-col","justify-center"],[1,"sm:mx-auto","sm:w-1/2","sm:max-w-2xl"],["src","assets/logo.jpeg","alt","Logo",1,"mx-auto","h-32","w-auto"],[1,"mt-3","text-center","text-2xl","font-bold","leading-9","tracking-tight","text-violet-950"],[1,"sm:mx-auto","sm:w-1/3","sm:max-w-2xl"],[1,"space-y-2",3,"formGroup"],["for","name",1,"block","text-sm","font-medium","leading-6","text-gray-900"],[1,"mt-2"],["formControlName","name","name","name","type","text","autocomplete","nombre","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6",3,"readonly"],[4,"ngIf"],["for","lastname",1,"block","text-sm","font-medium","leading-6","text-gray-900"],["formControlName","last_name","name","lastname","type","text","autocomplete","nombre","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6",3,"readonly"],["for","hospital",1,"block","text-sm","font-medium","leading-6","text-gray-900"],["formControlName","id_hospital","name","hospital","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["type","button","class","flex w-full justify-center rounded-md bg-fuchsia-500 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",3,"click",4,"ngIf"],["class","text-red-500 font-medium text-sm",4,"ngIf"],[1,"text-red-500","font-medium","text-sm"],[3,"value"],[1,"text-green-500","font-medium","text-sm"],["type","button",1,"flex","w-full","justify-center","rounded-md","bg-fuchsia-500","px-3","py-1.5","text-sm","font-semibold","leading-6","text-white","shadow-sm","hover:bg-cyan-700","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600",3,"click"]],template:function(p,m){p&1&&(i(0,"app-side-tool")(1,"div",0)(2,"div",1),g(3,"img",2),i(4,"h2",3),a(5,"Actualizar Perfil"),t()(),i(6,"div",4)(7,"form",5)(8,"div")(9,"label",6),a(10,"Nombre"),t(),i(11,"div",7),g(12,"input",8),t(),c(13,K,5,4,"div",9),t(),i(14,"div")(15,"label",10),a(16,"Apellidos"),t(),i(17,"div",7),g(18,"input",11),t(),c(19,ee,5,4,"div",9),t(),i(20,"div")(21,"label",12),a(22,"Hospital"),t(),i(23,"div",7)(24,"select",13),c(25,te,2,2,"option",14),t()()(),c(26,ie,3,0,"div",9),i(27,"div"),c(28,oe,2,0,"button",15)(29,ne,2,0,"button",15),t()()()()()),p&2&&(n(7),r("formGroup",m.profileForm),n(5),r("readonly",!m.IsEditable),n(),r("ngIf",m.profileForm.controls.name.errors),n(5),r("readonly",!m.IsEditable),n(),r("ngIf",m.profileForm.controls.last_name.errors),n(5),r("disabled",!m.IsEditable),n(),r("ngForOf",m.hospitales),n(),r("ngIf",m.succesMessages.update),n(2),r("ngIf",!m.IsEditable),n(),r("ngIf",m.IsEditable))},dependencies:[R,D,L,z,G,P,A,N,V,O,M,j,w,C,I]});let e=o;return e})();export{ge as ProfileComponent};
