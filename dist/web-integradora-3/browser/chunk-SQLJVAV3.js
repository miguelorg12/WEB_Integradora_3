import{a as z}from"./chunk-LL344L2T.js";import{a as J}from"./chunk-RMDRK64P.js";import{a as B}from"./chunk-N7WXRUGI.js";import{a as L}from"./chunk-NHY6G2KS.js";import"./chunk-VZAEZB6E.js";import{b as x,c as q,d as N,e as O,f as v,g as j,i as V,j as R,k as A,l as G,m as H,o as $,q as D}from"./chunk-FJBITYPR.js";import{a as M}from"./chunk-67ANC6KW.js";import{j as T}from"./chunk-6X3NTM2I.js";import{Ab as u,Ib as c,Jb as f,Kb as E,Qb as I,Sa as s,Ta as g,ga as b,gb as m,ib as l,jc as F,kc as k,lc as w,pa as S,qa as C,qb as n,rb as o,sb as h,vb as y,yb as _}from"./chunk-QODOQ2ZI.js";function P(e,r){if(e&1&&(n(0,"option",16),c(1),o()),e&2){let i=r.$implicit;l("value",i.id),s(),f(i.nombre)}}function Q(e,r){e&1&&(n(0,"p",18),c(1,"El hospital es requerido"),o())}function U(e,r){if(e&1&&(n(0,"div"),m(1,Q,2,0,"p",17),o()),e&2){let i=u(2);s(),l("ngIf",i.Form.controls.id_hospital.errors.required)}}function W(e,r){if(e&1&&(n(0,"div")(1,"label",7),c(2,"Hospital"),o(),n(3,"div",11)(4,"select",15),m(5,P,2,2,"option",13),o(),m(6,U,2,1,"div",6),o()()),e&2){let i=u();s(5),l("ngForOf",i.hospitales),s(),l("ngIf",i.Form.controls.id_hospital.errors&&i.Form.controls.id_hospital.touched)}}function X(e,r){if(e&1){let i=y();n(0,"div")(1,"label")(2,"input",19),_("change",function(d){let a=S(i).$implicit,p=u();return C(p.agregarSensor(d,a.id))}),o(),c(3),o()()}if(e&2){let i=r.$implicit;s(2),l("value",i.id),s(),E(" ",i.nombre," ")}}function Y(e,r){e&1&&(n(0,"div")(1,"p",18),c(2,"Al menos 1 sensor es requerido"),o()())}function Z(e,r){if(e&1&&(n(0,"option",16),c(1),o()),e&2){let i=r.$implicit;l("value",i.id),s(),f(i.estado)}}function ee(e,r){e&1&&(n(0,"p",18),c(1,"El estado es requerido"),o())}function te(e,r){if(e&1&&(n(0,"div"),m(1,ee,2,0,"p",17),o()),e&2){let i=u();s(),l("ngIf",i.Form.controls.id_estado.errors.required)}}function ie(e,r){if(e&1&&(n(0,"div")(1,"p",20),c(2),o()()),e&2){let i=u();s(2),f(i.succesMessages.message)}}function oe(e,r){if(e&1&&(n(0,"div")(1,"p",18),c(2),o()()),e&2){let i=u();s(2),f(i.backendErrors.message)}}var fe=(()=>{let r=class r{constructor(t,d,a,p,K){this.router=t,this.incubadorasService=d,this.hospitalesService=a,this.sensoresService=p,this.cookies=K,this.hospitales=[],this.estados=[],this.sensoresSeleccionados=[],this.sensores=[],this.backendErrors={},this.succesMessages={},this.Form=new O({id_hospital:new v(""),id_estado:new v("",[x.required]),id_sensores:new v([],[x.required])})}ngAfterContentInit(){this.id_rol=this.cookies.get("id_rol"),this.hospitalesService.getHospitales().subscribe({next:t=>{this.hospitales=t.Hospitales,console.log(this.hospitales)},error:t=>{console.log(t)}}),this.sensoresService.getSensores().subscribe({next:t=>{console.log(t),this.sensores=t.data,console.log(this.sensores)},error:t=>{console.log(t)}}),this.incubadorasService.getEstadosIncubadora().subscribe({next:t=>{this.estados=t.estado,console.log(this.estados)},error:t=>{console.log(t)}})}agregarSensor(t,d){if(t.target.checked)this.sensoresSeleccionados.push(d);else{let p=this.sensoresSeleccionados.indexOf(d);p>-1&&this.sensoresSeleccionados.splice(p,1)}let a=this.Form.get("id_sensores");a&&a.setValue(this.sensoresSeleccionados)}crearIncubadora(){console.log(this.Form.value),this.Form.valid&&this.sensoresSeleccionados.length>0?this.incubadorasService.createIncubadora(this.Form.value).subscribe({next:t=>{this.succesMessages.message="Incubadora creada con exito",this.backendErrors="",setTimeout(()=>{this.router.navigate(["/incubadoras"]),this.succesMessages=""},3e3),console.log(t)},error:t=>{this.backendErrors=t.error,this.succesMessages="",this.backendErrors={message:"Error al crear incubadora, intente mas tarde"},console.log(t)}}):this.backendErrors={message:"Al menos 1 sensor es requerido"}}};r.\u0275fac=function(d){return new(d||r)(g(T),g(J),g(L),g(z),g(M))},r.\u0275cmp=b({type:r,selectors:[["app-create"]],standalone:!0,features:[I],decls:26,vars:8,consts:[[1,"flex","mt-10","flex-col","justify-center"],[1,"sm:mx-auto","sm:w-1/2","sm:max-w-2xl"],["src","assets/logo.jpeg","alt","Logo",1,"mx-auto","h-32","w-auto"],[1,"mt-3","text-center","text-2xl","font-bold","leading-9","tracking-tight","text-violet-950"],[1,"sm:mx-auto","sm:w-1/3","sm:max-w-2xl"],[1,"space-y-2",3,"formGroup"],[4,"ngIf"],["for","hospital",1,"block","text-sm","font-medium","leading-6","text-gray-900"],[1,"grid","grid-cols-3","gap-4"],[4,"ngFor","ngForOf"],["for","maintenance",1,"block","text-sm","font-medium","leading-6","text-gray-900"],[1,"mt-2"],["formControlName","id_estado","name","maintenance","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6"],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"flex","w-full","justify-center","rounded-md","bg-fuchsia-500","px-3","py-1.5","text-sm","font-semibold","leading-6","text-white","shadow-sm","hover:bg-cyan-700","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600",3,"click"],["formControlName","id_hospital","name","hospital","required","",1,"pl-3","block","w-full","rounded-md","border-0","py-1.5","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-indigo-600","sm:text-sm","sm:leading-6"],[3,"value"],["class","text-red-500 font-medium text-sm",4,"ngIf"],[1,"text-red-500","font-medium","text-sm"],["type","checkbox",3,"change","value"],[1,"text-green-500","font-medium","text-sm"]],template:function(d,a){d&1&&(h(0,"app-toolbar"),n(1,"div",0)(2,"div",1),h(3,"img",2),n(4,"h2",3),c(5,"Registrar Incubadora"),o()(),n(6,"div",4)(7,"form",5),m(8,W,7,2,"div",6),n(9,"label",7),c(10,"Agregar Sensores"),o(),n(11,"div",8),m(12,X,4,2,"div",9),o(),m(13,Y,3,0,"div",6),n(14,"div")(15,"label",10),c(16,"Estado del Mantenimiento"),o(),n(17,"div",11)(18,"select",12),m(19,Z,2,2,"option",13),o(),m(20,te,2,1,"div",6),o()(),m(21,ie,3,1,"div",6)(22,oe,3,1,"div",6),n(23,"div")(24,"button",14),_("click",function(){return a.crearIncubadora()}),c(25,"Registrar Incubadora"),o()()()()()),d&2&&(s(7),l("formGroup",a.Form),s(),l("ngIf",a.id_rol==1),s(4),l("ngForOf",a.sensores),s(),l("ngIf",a.sensoresSeleccionados.length===0),s(6),l("ngForOf",a.estados),s(),l("ngIf",a.Form.controls.id_estado.errors&&a.Form.controls.id_estado.touched),s(),l("ngIf",a.succesMessages.message),s(),l("ngIf",a.backendErrors.message))},dependencies:[B,D,j,G,H,A,q,N,$,V,R,w,F,k]});let e=r;return e})();export{fe as CreateComponent};
